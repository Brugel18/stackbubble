<html>
<head>
  <script language="javascript" type="text/javascript"  src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
  <script language="javascript" type="text/javascript" src="arbor/arbor.js" ></script>
  <script language="javascript" type="text/javascript" src="arbor/graphics.js" ></script>
  <script language="javascript" type="text/javascript" src="arbor/renderer.js" ></script>
  <script language="javascript" type="text/javascript" src="arbor/arbor-tween.js" ></script>
</head>
<style>
body{
  background-color: #F2F0F0;
  background:  url(img/ARGH.png);
  background-size: 200px;

}
#viewport{

}
#header{
  height: 60px;
  width: 2000px;
  background-color: #49556C;
  margin: -10 0 0 -10;
  padding: 0 0 0 0;
}
#wrapper{
  width: 100%;
  padding; 0 0 0 0;
  margin: 0 0 0 0;
}
</style>
<body>
  <div id="wrapper">

    <div id = "header">
    </div>
    <canvas id="viewport" width="1600" height="1000"></canvas>
  </div>
  <script language="javascript" type="text/javascript">

            //var fileStuff = $.getJSON("python-stackexchange-api/testpiece/allthenames.json");
            //var obj = JSON.parse(msg);
            //var data = {};
            //data[0] = msg;
           
            

            var c=document.getElementById('viewport');
            var ctx=c.getContext('2d');
            

            var sys = arbor.ParticleSystem({repulsion: 100, stiffness: 10, friction: 8, gravity: true});
            sys.parameters({gravity:true});
            sys.renderer = Renderer("#viewport");


            var msg = $.ajax({type: "GET", url: "python-stackexchange-api/TheG20/allthenames.json", async: false}).responseText;
            var obj12 = jQuery.parseJSON(msg);


            var data = {nodes:{},};
            
            for(i = 0; i<30;i++){
              var colorChange = getRandomColor();
              obj12[i].color = colorChange;
              data.nodes[i] = obj12[i];
              console.log(data.nodes[i]);
            }

            
            sys.graft(data);
            console.log(sys.graft[0])
            setTimeout(function(){
  
           },10);
            var stack = new Array();
          //console.log("DATA: " + nodes.length)
          $(viewport).mouseup(function(e){


            var cage = {
             nodes:{
            "100":{"color":"black","shape":"dot","label":"Strings", "size": "60", "isExploded":false, "precedence": 2,"filename" : "Cage"}

            }, 
            edges:{
            }
          };
          sys.graft(cage);

        });
          $(viewport).mousedown(function(e){
            var pos = $(this).offset();
            var p = {x:e.pageX-pos.left, y:e.pageY-pos.top}
            selected = nearest = dragged = sys.nearest(p);


            if (selected.node !== null)
            {
              dragged.node.fixed = true;
              if (selected.node.isExploded == true){
               dragged.node.isExploded = false;
               sys.tweenNode(selected.node, 1, {color: getRandomColor(), size: 60})
             }
             else
             {
              sys.tweenNode(selected.node, 1, {color: getRandomColor(), size: 500})
              dragged.node.isExploded = true;
                  //console.log(dragged.node.isExploded)
                }
              /**
              if(selected.node.precedence == 1)
              {
                stack = sys.getEdges(selected.node)
                console.log("stack")
                sys.pruneNode(selected.node)
              }**/       
            }
            return false;
          });
function getRandomColor() {
  var letters = '0123456789ABCDEF'.split('');
  var color = '#';
  for (var i = 0; i < 6; i++ ) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}
</script>
</body> 
</html>