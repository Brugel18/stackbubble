<html>
    <head>
        <script language="javascript" type="text/javascript"  src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
        <script language="javascript" type="text/javascript" src="arbor/arbor.js" ></script>
        <script language="javascript" type="text/javascript" src="arbor/graphics.js" ></script>
        <script language="javascript" type="text/javascript" src="arbor/renderer.js" ></script>
        <script language="javascript" type="text/javascript" src="arbor/arbor-tween.js" ></script>

    </head>
    <body>
          <canvas id="viewport" width="800" height="600"></canvas>
          <script language="javascript" type="text/javascript">
            var sys = arbor.ParticleSystem({repulsion: 50, stiffness: 100, friction: 7, gravity: true});
            sys.parameters({gravity:true});
            sys.renderer = Renderer("#viewport");
            var data = {
               nodes:{
                 Python:{'color':getRandomColor(),'shape':'dot','label':'Python', 'size': 60, 'isExploded':false, "precedence": 0.5},
                 Java:{'color':getRandomColor(),'shape':'dot','label':'Java', 'size': 60, 'isExploded':false, "precedence": 0.5},
                 C:{'color':getRandomColor(),'shape':'dot','label':'C', 'size': 60, 'isExploded':false, "precedence": 0.5}
               }, 
             };
            sys.graft(data);
            setTimeout(function(){
              var keywords = {
                 nodes:{
                   StringsJava:{'color':getRandomColor(),'shape':'dot','label':'Strings', 'size': 60, 'isExploded':false, "precedence": 2},
                   VariablesPython:{'color':'green','shape':'dot','label':'Variables', 'size': 60, 'isExploded':false, "precedence": 2},
                   TreesPython:{'color':getRandomColor(),'shape':'dot','label':'Trees', 'size': 60, 'isExploded':false, "precedence": 2}
                 }, 
                 edges:{
                      StringsJava:{Java:{} },
                      VariablesPython:{ Python:{} },
                      TreesPython:{ Python:{} }
                 }
               };
               sys.graft(keywords);
          },10);
          var stack = new Array();
          //console.log("DATA: " + nodes.length)

          $(viewport).mousedown(function(e){
            var pos = $(this).offset();
            var p = {x:e.pageX-pos.left, y:e.pageY-pos.top}
            selected = nearest = dragged = sys.nearest(p);


            if (selected.node !== null)
            {
              dragged.node.fixed = true;
              if (selected.node.isExploded == true){
                 dragged.node.isExploded = false;
                 sys.tweenNode(selected.node, 1, {color: getRandomColor(), size: 60})

              }
              else
              {
                  sys.tweenNode(selected.node, 1, {color: getRandomColor(), size: 100})
                  dragged.node.isExploded = true;
                  //console.log(dragged.node.isExploded)
              }
              /**
              if(selected.node.precedence == 1)
              {
                stack = sys.getEdges(selected.node)
                console.log("stack")
                sys.pruneNode(selected.node)
              }**/
            
            }

            return false;
        });
        function getRandomColor() {
            var letters = '0123456789ABCDEF'.split('');
            var color = '#';
            for (var i = 0; i < 6; i++ ) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

    </script>
    </body> 

</html>